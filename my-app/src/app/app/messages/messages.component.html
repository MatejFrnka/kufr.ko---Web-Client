<div class="container">
  <div id="people">
    <div class="header">
      <div>
        <h1>Kufr.ko</h1>
      </div>
    </div>
    <div class="body">
      <div id="search">
        <input type="text" [placeholder]="SidePanelNumber==0?'Search..':'Find friends..'" autocomplete="off" [(ngModel)]="Search"/>
      </div>
      <div id="people">
        <div class="scroll">
          <!--GROUPS-->
          <div *ngIf="SidePanelNumber == 0" id="groups">
            <div *ngFor="let group of groups">
              <a class="user" *ngIf="group.Name.includes(Search)" (click)="selectedGroupId = group.Id" [class.selected]="group.Id==selectedGroupId"
                (click)="loadMessages(group.Id)">
                <div class="picture">
                  <span *ngIf="group.NewMessages != null && group.NewMessages > 0" class="notification">{{group.NewMessages>99?'99+':group.NewMessages}}</span>
                  <div style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
                </div>
                <div class="text" [class.highlighted]="group.NewMessages != null && group.NewMessages > 0" [class.seen]="group.NewMessages == null || group.NewMessages >= 0">
                  <h2>{{group.Name}}</h2>
                  <p>{{trimStr(group.LastMessageText,26)}}</p>
                  <p><small>{{calcLastOnline(group.LastMessageDate)}}</small></p>
                </div>
              </a>
            </div>
          </div>
          <!--PEOPLE-->
          <div *ngIf="SidePanelNumber == 1" id="people">
            <div class="heading">
              <h2>Friend requests</h2>
            </div>
            <a class="person" *ngFor="let person of pendingFriends">
              <div class="ppicture">
                <div style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
              </div>

              <div class="request">
                <div>
                  <h3 title="{{person.Name}}">{{trimStr(person.Name, 12)}}</h3>
                </div>
                <div>
                  <div class="btn">
                    <img src="../../../assets/Accept.svg" alt="Accept friend request" (click)="changeUserStatus(person.Id, 1)" />
                  </div>
                </div>
                <div>
                  <div class="btn">
                    <img src="../../../assets/Deny.svg" alt="Deny friend request" (click)="changeUserStatus(person.Id, 0)" />
                  </div>
                </div>
                <div class="btn">
                  <div>
                    <img src="../../../assets/Block.svg" alt="Block user" (click)="changeUserStatus(person.Id, 2)" />
                  </div>
                </div>
              </div>
            </a>

            <div class="heading">
              <h2>Friends</h2>
            </div>

            <a class="person" *ngFor="let person of friends">
              <div class="ppicture">
                <div style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
              </div>
              <div class="friend">
                <div>
                  <h3 title="{{person.Name}}">{{trimStr(person.Name, 12)}}</h3>
                </div>
                <div class="btn">
                  <img src="../../../assets/UserSettings.svg" alt="User settings" />
                </div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <div [class.highlighted]="SidePanelNumber == 0" (click)="SidePanelNumber = 0">
        <div class="bgIcon" style="background-image: url('../../../assets/Messages.svg');">
          <span class="notification">12</span>
        </div>
      </div>
      <div (click)="SidePanelNumber = 1" [class.highlighted]="SidePanelNumber == 1">
        <div class="bgIcon" style="background-image: url('../../../assets/Groups.svg');">
          <span class="notification">12</span>
        </div>
      </div>
    </div>
  </div>
  <div id="messages">
    <div class="header">
      <div class="heading">
        <div class="hpicture">
          <div style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
        </div>
        <div>
          <h2>{{findGroupById(selectedGroupId).Name}}</h2>
          <p><small>• Online</small></p>
        </div>
      </div>
    </div>
    <div class="body">
      <div class="scroll" id="messageBody">

        <!--MESSAGES-->
        <div class="message" *ngFor="let message of (messages[selectedGroupId]==undefined?messages[selectedGroupId]:messages[selectedGroupId].reverse());index as i;"
          [ngClass]="{
          'sent': message.UserIsSender,
          'recieved': !message.UserIsSender }">
          <div class="msgpic" [ngStyle]="{
            'background-image': isLastOfGroup(i, selectedGroupId)?'url(https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg)':''
          }"></div>
          <div class="content text">{{message.Text}}</div>
        </div>
        <div class="message" *ngFor="let message of pendingMessages[selectedGroupId];" [ngClass]="{
          'sent': message.UserInfo.Id == currentUser.Id,
          'recieved': message.UserInfo.Id != currentUser.Id
        }">
          <div class="msgpic" style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
          <div class="content text">{{message.Text}}</div>
        </div>
        <div id="bottom"></div>
        <!--
        <div class="message recieved">
          <div class="msgpic" style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
          <div class="content img">
            <img src="https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg" alt="" />
          </div>
        </div>
        <div class="message sent">
          <div class="msgpic" style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
          <div class="content text">Ahoj, jak se máš pepo?</div>
        </div>
        <div class="message sent">
          <div class="msgpic" style="background-image: url('https://cdn-images-1.medium.com/fit/c/100/100/0*EdUYcQhX6TPWdQ6p.jpg')"></div>
          <div class="content text">Ahoj, jak se máš pepo?</div>
        </div>-->
      </div>
    </div>
    <div class="footer">
      <div class="sendInput">
        <input type="text" placeholder="Send a message..." name="messageText" [(ngModel)]="messageInput"
          (keydown.enter)="sendMessage()" />
      </div>
      <div class="sendButton">
        <img src="../../../assets/Upload.svg" alt=""/>
      </div>
      <div class="sendButton">
        <img src="../../../assets/Send.svg" alt="" (click)="sendMessage()" (keydown)="sendMessage()" />
      </div>
    </div>
  </div>
</div>
